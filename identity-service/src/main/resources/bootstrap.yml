server:
  port: ${PORT:9096}
spring:
  application:
    name: identity-service
  cloud:
    config:
      uri: ${CONFIG_SERVER_URI:http://localhost:8888}
      failFast: ${CONFIG_SERVER_FAILFAST:false}
    discovery:
      enabled: ${DISCOVERY_ENABLED:false}
  jpa:
    show-sql: false
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update
#      use-new-id-generator-mappings: true
  datasource:
    driverClassName: org.postgresql.Driver
    url: jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:identityDB}
    username: ${POSTGRES_USER:root}
    password: ${POSTGRES_PASSWORD:changeme}
  mail:
    debug: false  # disable printing email to log output
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:25}
    defaultFrom: ${SMTP_DEFAULT_FROM:}
    username: ${SMTP_USERNAME:}
    password: ${SMTP_PASSWORD:}
    smtp.auth: true
    properties.mail.smtp.starttls.enable: true
  jackson:
    default-property-inclusion: NON_NULL

logstash:
  uri: ${LOGSTASH_URI:localhost:5000}

nimble:
  corsEnabled: false
  uaa:
    url: ${UAA_URI:http://localhost:9090}
    clientid: ${UAA_CLIENT_ID:sultans}
    clientsecret: ${UAA_CLIENT_SECRET:sultanssecret}
  keycloak:
    serverUrl: ${KEYCLOAK_URL:http://localhost:10096/auth}
    realm: ${KEYCLOAK_REALM:master}
    admin:
      username: ${KEYCLOAK_ADMIN_USERNAME:admin}
      password: ${KEYCLOAK_ADMIN_PASSWORD:password}
      cliendId: ${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}
      cliendSecret: ${KEYCLOAK_ADMIN_CLIENT_SECRET}
  oauth:
    client:
      cliendId: ${OAUTH_CLIENT_ID:nimble-client}
      cliendSecret: ${OAUTH_CLIENT_SECRET}
      accessTokenUri: ${OAUTH_CLIENT_ACCESSTOKEN_URI}
  frontend:
    url: ${FRONTEND_URL:http://localhost:9092}

---

spring:
  profiles: kubernetes

nimble:
  db-credentials-json: ${DB_CREDENTIALS_JSON}
  corsEnabled: true

---

spring:
  profiles: local_dev
  jpa:
    properties:
      hibernate:
        temp:
          use_jdbc_metadata_defaults: false
        show_sql: false
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: none
  h2:
    console:
      enabled: true
      path: /h2-console
  datasource:
    name: identitydb
    driverClassName: org.h2.Driver
#    url: jdbc:h2:mem:test;DB_CLOSE_DELAY=-1
    url: jdbc:h2:file:~/identitydb;DB_CLOSE_ON_EXIT=FALSE;DB_CLOSE_DELAY=-1;
    initialize: false
    username: sa
    password: sa
  mail:
    debug: true  # prints email to log output
    host: localhost # in-v3.mailjet.com
    port: 8465 # 465

nimble:
  corsEnabled: true
